@model EPMS.Web.ViewModels.Payroll.PayrollViewModel

@{
    ViewBag.Title = "Payroll Page";
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.MessageVM = TempData["message"];
}

<!-- Navigation Bar -->
<div class="breadcrumb-container">
    <ul class="xbreadcrumbs">
        <li>
            <a href="~/Dashboard/Index">
                <i class="icon-photon home"></i>
            </a>
        </li>
        <li class="current">
            <a href="javascript:;">@ViewBag.Title</a>
        </li>
    </ul>
</div>
<!-- Page heading -->
<header>
    <i class="icon-big-notepad"></i>
    <h2><small>@ViewBag.Title</small></h2>
    <h3> <small><a href=""></a></small></h3>
</header>
<!--Notifications begin-->
@Html.Partial("_Alert")

<div class="container-fluid">
    <form class="form-horizontal">
        <div class="row-fluid">
            <div class="span12">
                <table id="EmployeePayrollList" class="table table-striped table-responsive">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Image</th>
                            <th>Name</th>
                            <th>Job ID</th>
                            <th>Job Title</th>
                            <th>Department</th>
                        </tr>
                    </thead><tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </form>
</div>

<script>
    $(document).ready(function () {
        var siteUrl = $('#siteURL').val();
        var start = ('@Model.SearchRequest.PageNo' - 1) * '@Model.SearchRequest.PageSize';
        var isAsc = '@Model.SearchRequest.IsAsc' == "True" || '@Model.SearchRequest.IsAsc' == "true";
        var sortBy = ['@Model.SearchRequest.SortBy', isAsc ? 'asc' : 'desc'];
        var oTable = $('#EmployeePayrollList').dataTable({
            "iDisplayLength": 11,
            "iDisplayStart": start || 0,
            "aaSorting": [sortBy],
            "bProcessing": true,
            "bServerSide": true,
            "bFilter": true,
            "aoColumns": [
                {
                    "aTargets": [0],
                    "sDefaultContent": "No Data",
                    "mRender": function (data, type, full) {
                        return full["EmployeeId"];
                    },
                    "bVisible": false,
                },
                {
                    "aTargets": [1],
                    "sDefaultContent": "No Data",
                    "mRender": function (data, type, full) {
                        return full["EmployeeImagePath"];
                    },
                },
                {
                    "aTargets": [2],
                    "sDefaultContent": "No Data",
                    "mRender": function (data, type, full) {
                        var val = full["EmployeeNameE"];
                        var empId = full["EmployeeId"];
                        var element = '<a href="Create/' + empId + '">' + val + '</a>';
                        return element;
                    }
                },
                {
                    "aTargets": [3],
                    "sDefaultContent": "No Data",
                    "mRender": function (data, type, full) {
                        return full["JobTitleId"];
                    }
                },
                {
                    "aTargets": [4],
                    "sDefaultContent": "No Data",
                    "mRender": function (data, type, full) {
                        return full["JobTitleNameE"];
                    }
                },
                {
                    "aTargets": [5],
                    "sDefaultContent": "No Data",
                    "mRender": function (data, type, full) {
                        return full["DepartmentNameE"];
                    }
                }
            ],
            "sAjaxSource": siteUrl + "/Payroll/Index",
            "sServerMethod": "POST",
            "oLanguage": {
                "sProcessing": "Fetching record(s)",
                "sInfoEmpty": "No matching record(s) found",
                "sEmptyTable": "No record(s) found",
            }
        });
        $(".dataTables_length select").select2({
            dropdownCssClass: 'noSearch'
        });
    });
</script>
