@using System.Configuration
@using System.Globalization
@using EPMS.WebModels.Resources.WebsiteClient.Product
@using EPMS.Website.Resources.Shared
@model EPMS.WebModels.ViewModels.Product.ProductListViewModel

@{
    ViewBag.Title = Product.PageTitle;
    Layout = "~/Views/Shared/_Layout.cshtml";
    var direction = Common.TextDirection;
    string requestFrom = "";
    if (ViewBag.From != null)
    {
        requestFrom = ViewBag.From.ToString();
    }
    string itemImageFolder = "";
    if (requestFrom == "Inventory")
    {
        itemImageFolder = ConfigurationManager.AppSettings["InventoryImage"];
    }
    if (requestFrom == "Sections")
    {
        itemImageFolder = ConfigurationManager.AppSettings["ProductImage"];
    }
    var siteURL = ConfigurationManager.AppSettings["SiteURL"];
    string noImage = siteURL + "/images/noimage_department.png";
    int pageNo = 1;
    DateTime today = DateTime.Now;
    var rootProducts = Model.ProductSections.Where(x => x.ParentSectionId == null).ToList();
    string link;
}

<div id="page_header" class="gradient bottom-shadow">
    <div class="bgback bg3"></div>
    <div class="container">
        <div class="row">
            <div class="span6">
                <ul class="breadcrumbs fixclear">
                    <li>@Product.HomePage</li>
                    <li>@Product.Products</li>
                </ul>
                <span id="current-date">@today.ToString("dddd, dd MMMM yyyy", CultureInfo.CreateSpecificCulture("en-US"))</span>
            </div>
            <div class="span6">
                <div class="header-titles">
                    <h2>@Product.Products</h2>
                    <h4>@Product.SelectByCatagory</h4>
                </div>
            </div>
        </div><!-- end row -->
    </div>
    <div class="shadowUP"></div>
</div>
<section id="content">
    <div class="container">
        <div id="mainbody">
            <div class="row">
                <div class="span3  directionR">
                    <h1 class="page-title">@Product.PoductClassification</h1>
                    <div class="css-treeview">
                        <ul>
                            <li class="phy">
                                @foreach (var productSection in rootProducts)
                                {
                                    var childName = "";
                                    if (direction == "ltr")
                                    {
                                        childName = string.IsNullOrEmpty(productSection.SectionNameEn) ? productSection.InventoryDepartment.DepartmentNameEn : productSection.SectionNameEn;
                                    }
                                    else
                                    {
                                        childName = string.IsNullOrEmpty(productSection.SectionNameAr) ? productSection.InventoryDepartment.DepartmentNameAr : productSection.SectionNameAr;
                                    }

                                    {
                                        if (productSection.InventoyDepartmentId != null)
                                        {
                                            link = siteURL + "/Product/Index/" + productSection.InventoyDepartmentId + "?from=Inventory";
                                        }
                                        else
                                        {
                                            link = siteURL + "/Product/Index/" + productSection.SectionId + "?from=Sections";
                                        }
                                    }
                                    <input type="checkbox" id="item-0" />
                                    <label for="item-0"><a href="@link">@childName</a></label>
                                    if (productSection.InventoryDepartment != null)
                                    {
                                        <ul>
                                            @foreach (var department in productSection.InventoryDepartment.InventoryDepartments)
                                            {
                                                <li class="phy">
                                                    @{
                                                childName = direction == "ltr" ? department.DepartmentNameEn : department.DepartmentNameAr;
                                                link = siteURL + "/Product/Index/" + department.DepartmentId + "?from=Inventory";
                                                <input type="checkbox" id="item-0-0" />
                                                        <label for="item-0-0"><a href="@link">@childName</a></label>
                                                    }
                                                    @if (department.InventoryDepartments.Any())
                                                    {
                                                        <ul>
                                                            @foreach (var childDepartment in department.InventoryDepartments)
                                                            {
                                                                <li class="phy">
                                                                    @{
                                                                childName = direction == "ltr" ? childDepartment.DepartmentNameEn : childDepartment.DepartmentNameAr;
                                                                link = siteURL + "/Product/Index/" + childDepartment.DepartmentId + "?from=Inventory";
                                                                <input type="checkbox" id="item-0-0-0" />
                                                                        <label for="item-0-0-0"><a href="@link">@childName</a></label>
                                                                    }
                                                                </li>
                                                            }
                                                        </ul>
                                                    }
                                                </li>
                                            }

                                        </ul>
                                    }
                                    if (productSection.ProductSections != null && productSection.ProductSections.Any())
                                    {
                                        <ul>
                                            @foreach (var section in productSection.ProductSections)
                                            {
                                                <li class="phy">
                                                    @{
                                                childName = direction == "ltr" ? section.SectionNameEn : section.SectionNameAr;
                                                link = siteURL + "/Product/Index/" + section.SectionId + "?from=Sections";
                                                <input type="checkbox" id="item-0-0" />
                                                        <label for="item-0-0"><a href="@link">@childName</a></label>
                                                    }
                                                    @if (section.ProductSections.Any())
                                                    {
                                                        <ul>
                                                            @foreach (var subSection in section.ProductSections)
                                                            {
                                                                <li class="phy">
                                                                    @{
                                                                childName = direction == "ltr" ? subSection.SectionNameEn : subSection.SectionNameAr;
                                                                link = siteURL + "/Product/Index/" + subSection.SectionId + "?from=Sections";
                                                                <input type="checkbox" id="item-0-0-0" />
                                                                        <label for="item-0-0-0"><a href="@link">@childName</a></label>
                                                                    }
                                                                </li>
                                                            }
                                                        </ul>
                                                    }
                                                </li>
                                            }

                                        </ul>
                                    }
                                    <br />
                                }
                            </li>

                        </ul>
                    </div>

                    <h1 class="page-title margintop10">@Product.Catalog</h1>
                    <a href="~/Catalogue/Index"><img src="@siteURL/images/shop_images/catalog.jpg"></a>
                </div>
                @using (Html.BeginForm("Index", "Product", FormMethod.Post, new { @class = "form-horizontal", @id = "filter-products", role = "form", enctype = "multipart/form-data" }))
                {
                    @Html.HiddenFor(model => model.SearchRequest.Id)
                    @Html.HiddenFor(model => model.SearchRequest.From)
                    @Html.HiddenFor(model => model.SearchRequest.SortDirection, new { @id = "SortDirection" })
                    @Html.HiddenFor(model => model.SearchRequest.iSortCol_0, new { @id = "sortCol" })
                    @Html.HiddenFor(model => model.SearchRequest.iDisplayStart, new { @id = "displayStart" })
                    <div class="span9 directionR">
                        <h1 class="page-title">@Product.Products</h1>
                        <div class="row">
                            <div class="span9 linebot center-sm margintopLess10">
                                <div class="filtersgroup">
                                    <div class="limit">
                                        <span>@Product.Search:</span>
                                        @Html.TextBoxFor(model => model.SearchRequest.SearchString, new { @class = "inputbox filter" })
                                    </div>
                                    <div class="limit">
                                        <span>@Product.Show:</span>
                                        @Html.DropDownListFor(model => model.SearchRequest.iDisplayLength, new[]
                                        {
                                            new SelectListItem { Value = "3" , Text = "3" },
                                            new SelectListItem { Value = "6" , Text = "6" },
                                            new SelectListItem { Value = "9" , Text = "9" },
                                            new SelectListItem { Value = "60" , Text = "60" },
                                            new SelectListItem { Value = "90" , Text = "90" }
                                        }, new { @id = "displayLength", @class = "filter" })
                                    </div>
                                    <div class="sort">
                                        <span>@Product.SortBy:</span>
                                        @if (direction == "ltr")
                                        {
                                            @Html.DropDownListFor(model => model.SearchRequest.SortBy, new[]
                                            {
                                                new SelectListItem {Value = "1", Text = Product.ByNameASC},
                                                new SelectListItem {Value = "2", Text = Product.ByNameDesc},
                                                new SelectListItem {Value = "3", Text = Product.ByLowestPrice},
                                                new SelectListItem {Value = "4", Text = Product.ByHighestPrice}
                                            }, new { @id = "SortBy", @class = "filter" })
                                        }
                                        else
                                        {
                                            @Html.DropDownListFor(model => model.SearchRequest.SortBy, new[]
                                            {
                                                new SelectListItem {Value = "5", Text = Product.ByNameASC},
                                                new SelectListItem {Value = "6", Text = Product.ByNameDesc},
                                                new SelectListItem {Value = "3", Text = Product.ByLowestPrice},
                                                new SelectListItem {Value = "4", Text = Product.ByHighestPrice}
                                            }, new { @id = "SortBy", @class = "filter" })
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                        @if (Model.Products.Any())
                        {
                            for (int i = 0; i < Model.Products.Count; i += 3)
                            {
                                <div class="row">
                                    @for (int j = i; j < (i + 3) && j < Model.Products.Count; j++)
                                    {
                                        <div class="span3">
                                            <div class="product-list-item">
                                                <span class="hover"></span>
                                                <div class="image">
                                                    @{
                                                        string path = "";
                                                        if (requestFrom == "Inventory")
                                                        {
                                                            path = !string.IsNullOrEmpty(Model.Products[j].ItemImage) ? itemImageFolder + Model.Products[j].ItemImage : noImage;
                                                        }
                                                        if (requestFrom == "Sections")
                                                        {
                                                            path = !string.IsNullOrEmpty(Model.Products[j].ProductImage) ? itemImageFolder + Model.Products[j].ProductImage : noImage;
                                                        }
                                                        if (Model.Products[j].ItemVariationId != null)
                                                        {
                                                            <a href="@siteURL/Product/Details/@Model.Products[j].ProductId?from=Inventory">
                                                                <img src="@path" alt="">
                                                            </a>
                                                        }
                                                        else
                                                        {
                                                            <a href="@siteURL/Product/Details/@Model.Products[j].ProductId?from=Sections">
                                                                <img src="@path" alt="">
                                                            </a>
                                                        }
                                                    }
                                                </div>
                                                <div class="details fixclear">
                                                    @if (direction == "ltr")
                                                    {
                                                        <h3>@(Model.Products[j].ItemVariationId != null ? Model.Products[j].ItemNameEn : Model.Products[j].ProductNameEn)</h3>
                                                    }
                                                    else
                                                    {
                                                        <h3>@(Model.Products[j].ItemVariationId != null ? Model.Products[j].ItemNameAr : Model.Products[j].ProductNameAr)</h3>
                                                    }
                                                    <p><strong>@Product.SKU:</strong> @Model.Products[j].SKUCode</p>
                                                    <p class="desc">@(direction == "ltr" ? Model.Products[j].ProductDescEn : Model.Products[j].ProductDescAr)</p>
                                                    <div class="actions">
                                                        <a class="cursorHand" onclick="addToCart(@Model.Products[j].ProductId) ">@Product.AddToCart</a>
                                                        @if (Model.Products[j].ItemVariationId != null)
                                                        {
                                                            <a href="@siteURL/Product/Details/@Model.Products[j].ProductId?from=Inventory">@Product.More</a>
                                                        }
                                                        else
                                                        {
                                                            <a href="@siteURL/Product/Details/@Model.Products[j].ProductId?from=Sections">@Product.More</a>
                                                        }
                                                    </div>
                                                    <div class="price">
                                                        @if (!string.IsNullOrEmpty(Model.Products[j].DiscountedPrice))
                                                        {
                                                            <span>@Model.Products[j].DiscountedPrice</span>
                                                            <span>SR</span>
                                                            <small>@Model.Products[j].ProductPrice</small>
                                                        }
                                                        else
                                                        {
                                                            <span>@Model.Products[j].ProductPrice</span>
                                                            <span>SR</span>
                                                        }
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                </div>
                            }
                            <div class="span4">
                                <div class="pagination" id="pagination">
                                    <a><div class="cursorHand first-page"><i class="fa fa-long-arrow-right"></i></div></a>
                                    @for (int i = 0; i < Model.SearchRequest.TotalCount; i += Model.SearchRequest.iDisplayLength)
                                    {
                                        if (i == Model.SearchRequest.iDisplayStart)
                                        {
                                            <a class="active cursorHand"><div class="page-button">@pageNo</div></a>
                                        }
                                        else
                                        {
                                            <a class="cursorHand"><div class="page-button">@pageNo</div></a>
                                        }
                                        pageNo++;
                                    }
                                    <a><div class="cursorHand last-page"><i class="fa fa-long-arrow-left"></i></div></a>
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="row">
                                <h4>No product available.</h4>
                            </div>
                        }
                        
                    </div>
                }
            </div>
        </div><!-- end row -->
        <div class="row">
            <div class="span12 ">
                <div class="shop-latest">
                    <div class="tabbable">
                        <ul class="nav fixclear">
                            <li class="active"><a href="#tabpan1" data-toggle="tab">@Product.NewArrivals</a></li>
                            <li><a href="#tabpan2" data-toggle="tab">@Product.BestSell</a></li>
                            <li><a href="#tabpan3" data-toggle="tab">@Product.RamdomProducts</a></li>
                            <li><a href="#tabpan4" data-toggle="tab">@Product.FeaturedProducts</a></li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane active" id="tabpan1">
                                <div class="shop-latest-carousel">
                                    <ul id="latest_products" class="product-tabs">
                                        @if (Model.NewArrivals != null && Model.NewArrivals.Any())
                                        {
                                            foreach (var newArrival in Model.NewArrivals)
                                            {
                                                <li>
                                                    <div class="product-list-item  ">
                                                        <span class="hover"></span>
                                                        <div class="image">
                                                            @*<a href="pages-productitem.html"><img src="/images/shop_images/img1.png" alt=""></a>*@
                                                            @{
                                                string path = "";
                                                if (newArrival.ItemVariationId != null)
                                                {
                                                    path = !string.IsNullOrEmpty(newArrival.ItemImage) ? ConfigurationManager.AppSettings["InventoryImage"] + newArrival.ItemImage : noImage;
                                                }
                                                else
                                                {
                                                    path = !string.IsNullOrEmpty(newArrival.ProductImage) ? ConfigurationManager.AppSettings["ProductImage"] + newArrival.ProductImage : noImage;
                                                }
                                                if (newArrival.ItemVariationId != null)
                                                {
                                                    <a href="@siteURL/Product/Details/@newArrival.ProductId?from=Inventory">
                                                        <img src="@path" alt="">
                                                    </a>
                                                }
                                                else
                                                {
                                                    <a href="@siteURL/Product/Details/@newArrival.ProductId?from=Sections">
                                                        <img src="@path" alt="">
                                                    </a>
                                                }
                                                            }
                                                        </div>
                                                        <div class="details fixclear">
                                                            @if (direction == "ltr")
                                                            {
                                                                <h3>@(newArrival.ItemVariationId != null ? newArrival.ItemNameEn : newArrival.ProductNameEn)</h3>
                                                            }
                                                            else
                                                            {
                                                                <h3>@(newArrival.ItemVariationId != null ? newArrival.ItemNameAr : newArrival.ProductNameAr)</h3>
                                                            }
                                                            <p><strong>SKU:</strong> @newArrival.SKUCode</p>
                                                            <p class="desc">Quisque sit amet est et sapien ullamcorper pharetra...</p>
                                                            <div class="actions">
                                                                <a class="cursorHand" onclick="addToCart(@newArrival.ProductId)">@Product.AddToCart</a>
                                                                @if (newArrival.ItemVariationId != null)
                                                                {
                                                                    <a href="@siteURL/Product/Details/@newArrival.ProductId?from=Inventory">@Product.More</a>
                                                                }
                                                                else
                                                                {
                                                                    <a href="@siteURL/Product/Details/@newArrival.ProductId?from=Sections">@Product.More</a>
                                                                }
                                                            </div>
                                                            <div class="price">
                                                                @if (!string.IsNullOrEmpty(newArrival.DiscountedPrice))
                                                                {
                                                                    <span>@newArrival.DiscountedPrice</span>
                                                                    <span>SR</span>
                                                                    <small>@newArrival.ProductPrice</small>
                                                                }
                                                                else
                                                                {
                                                                    <span>@newArrival.ProductPrice</span><span>SR</span>
                                                                }
                                                            </div>
                                                        </div>
                                                    </div><!-- end product-item -->
                                                </li>
                                            }
                                        }
                                    </ul><!-- shop product list -->
                                    <div class="controls">
                                        <a href="#" class="prev"><span class="icon-chevron-left"></span></a>
                                        <a href="#" class="next"><span class="icon-chevron-right"></span></a>
                                    </div>
                                    <div class="clear"></div>
                                </div><!--end shop-latest-carousel -->
                            </div><!-- end tab pane -->
                            <div class="tab-pane" id="tabpan2">
                                <div class="shop-latest-carousel">
                                    <ul id="bestselling_products" class="product-tabs">
                                        @if (Model.BestSell != null && Model.BestSell.Any())
                                        {
                                            foreach (var bestSell in Model.BestSell)
                                            {
                                                <li>
                                                    <div class="product-list-item  ">
                                                        <span class="hover"></span>
                                                        <div class="image">
                                                            @*<a href="pages-productitem.html"><img src="/images/shop_images/img1.png" alt=""></a>*@
                                                            @{
                                                string path = "";
                                                if (bestSell.ItemVariationId != null)
                                                {
                                                    path = !string.IsNullOrEmpty(bestSell.ItemImage) ? ConfigurationManager.AppSettings["InventoryImage"] + bestSell.ItemImage : noImage;
                                                }
                                                else
                                                {
                                                    path = !string.IsNullOrEmpty(bestSell.ProductImage) ? ConfigurationManager.AppSettings["ProductImage"] + bestSell.ProductImage : noImage;
                                                }
                                                if (bestSell.ItemVariationId != null)
                                                {
                                                    <a href="@siteURL/Product/Details/@bestSell.ProductId?from=Inventory">
                                                        <img src="@path" alt="">
                                                    </a>
                                                }
                                                else
                                                {
                                                    <a href="@siteURL/Product/Details/@bestSell.ProductId?from=Sections">
                                                        <img src="@path" alt="">
                                                    </a>
                                                }
                                                            }
                                                        </div>
                                                        <div class="details fixclear">
                                                            @if (direction == "ltr")
                                                            {
                                                                <h3>@(bestSell.ItemVariationId != null ? bestSell.ItemNameEn : bestSell.ProductNameEn)</h3>
                                                            }
                                                            else
                                                            {
                                                                <h3>@(bestSell.ItemVariationId != null ? bestSell.ItemNameAr : bestSell.ProductNameAr)</h3>
                                                            }
                                                            <p><strong>SKU:</strong> @bestSell.SKUCode</p>
                                                            <p class="desc">Quisque sit amet est et sapien ullamcorper pharetra...</p>
                                                            <div class="actions">
                                                                <a class="cursorHand" onclick="addToCart(@bestSell.ProductId)">@Product.AddToCart</a>
                                                                @if (bestSell.ItemVariationId != null)
                                                                {
                                                                    <a href="@siteURL/Product/Details/@bestSell.ProductId?from=Inventory">@Product.More</a>
                                                                }
                                                                else
                                                                {
                                                                    <a href="@siteURL/Product/Details/@bestSell.ProductId?from=Sections">@Product.More</a>
                                                                }
                                                            </div>
                                                            <div class="price">
                                                                @if (!string.IsNullOrEmpty(bestSell.DiscountedPrice))
                                                                {
                                                                    <span>@bestSell.DiscountedPrice</span>
                                                                    <span>SR</span>
                                                                    <small>@bestSell.ProductPrice</small>
                                                                }
                                                                else
                                                                {
                                                                    <span>@bestSell.ProductPrice</span><span>SR</span>
                                                                }
                                                            </div>
                                                        </div>
                                                    </div><!-- end product-item -->
                                                </li>
                                            }
                                        }
                                    </ul><!-- shop product list -->
                                    <div class="controls">
                                        <a href="#" class="prev"><span class="icon-chevron-left"></span></a>
                                        <a href="#" class="next"><span class="icon-chevron-right"></span></a>
                                    </div>
                                    <div class="clear"></div>
                                </div><!--end shop-latest-carousel -->
                            </div>
                            <div class="tab-pane " id="tabpan3">
                                <div class="shop-latest-carousel">
                                    <ul id="latest_products2" class="product-tabs">
                                        @if (Model.RandomProducts != null && Model.RandomProducts.Any())
                                        {
                                            foreach (var randomProduct in Model.RandomProducts)
                                            {
                                                <li>
                                                    <div class="product-list-item  ">
                                                        <span class="hover"></span>
                                                        <div class="image">
                                                            @*<a href="pages-productitem.html"><img src="/images/shop_images/img1.png" alt=""></a>*@
                                                            @{
                                                string path = "";
                                                if (randomProduct.ItemVariationId != null)
                                                {
                                                    path = !string.IsNullOrEmpty(randomProduct.ItemImage) ? ConfigurationManager.AppSettings["InventoryImage"] + randomProduct.ItemImage : noImage;
                                                }
                                                else
                                                {
                                                    path = !string.IsNullOrEmpty(randomProduct.ProductImage) ? ConfigurationManager.AppSettings["ProductImage"] + randomProduct.ProductImage : noImage;
                                                }
                                                if (randomProduct.ItemVariationId != null)
                                                {
                                                    <a href="@siteURL/Product/Details/@randomProduct.ProductId?from=Inventory">
                                                        <img src="@path" alt="">
                                                    </a>
                                                }
                                                else
                                                {
                                                    <a href="@siteURL/Product/Details/@randomProduct.ProductId?from=Sections">
                                                        <img src="@path" alt="">
                                                    </a>
                                                }
                                                            }
                                                        </div>
                                                        <div class="details fixclear">
                                                            @if (direction == "ltr")
                                                            {
                                                                <h3>@(randomProduct.ItemVariationId != null ? randomProduct.ItemNameEn : randomProduct.ProductNameEn)</h3>
                                                            }
                                                            else
                                                            {
                                                                <h3>@(randomProduct.ItemVariationId != null ? randomProduct.ItemNameAr : randomProduct.ProductNameAr)</h3>
                                                            }
                                                            <p><strong>SKU:</strong> @randomProduct.SKUCode</p>
                                                            <p class="desc">Quisque sit amet est et sapien ullamcorper pharetra...</p>
                                                            <div class="actions">
                                                                <a class="cursorHand" onclick="addToCart(@randomProduct.ProductId)">@Product.AddToCart</a>
                                                                @if (randomProduct.ItemVariationId != null)
                                                                {
                                                                    <a href="@siteURL/Product/Details/@randomProduct.ProductId?from=Inventory">@Product.More</a>
                                                                }
                                                                else
                                                                {
                                                                    <a href="@siteURL/Product/Details/@randomProduct.ProductId?from=Sections">@Product.More</a>
                                                                }
                                                            </div>
                                                            <div class="price">
                                                                @if (!string.IsNullOrEmpty(randomProduct.DiscountedPrice))
                                                                {
                                                                    <span>@randomProduct.DiscountedPrice</span>
                                                                    <span>SR</span>
                                                                    <small>@randomProduct.ProductPrice</small>
                                                                }
                                                                else
                                                                {
                                                                    <span>@randomProduct.ProductPrice</span><span>SR</span>
                                                                }
                                                            </div>
                                                        </div>
                                                    </div><!-- end product-item -->
                                                </li>
                                            }
                                        }
                                    </ul><!-- shop product list -->
                                    <div class="controls">
                                        <a href="#" class="prev"><span class="icon-chevron-left"></span></a>
                                        <a href="#" class="next"><span class="icon-chevron-right"></span></a>
                                    </div>
                                    <div class="clear"></div>
                                </div><!--end shop-latest-carousel -->
                            </div><!-- end tab pane -->
                            <div class="tab-pane" id="tabpan4">
                                <div class="shop-latest-carousel">
                                    <ul id="bestselling_products4" class="product-tabs">
                                        @if (Model.FeaturedProducts != null && Model.FeaturedProducts.Any())
                                        {
                                            foreach (var featuredProduct in Model.FeaturedProducts)
                                            {
                                                <li>
                                                    <div class="product-list-item  ">
                                                        <span class="hover"></span>
                                                        <div class="image">
                                                            @*<a href="pages-productitem.html"><img src="/images/shop_images/img1.png" alt=""></a>*@
                                                            @{
                                                string path = "";
                                                if (featuredProduct.ItemVariationId != null)
                                                {
                                                    path = !string.IsNullOrEmpty(featuredProduct.ItemImage) ? ConfigurationManager.AppSettings["InventoryImage"] + featuredProduct.ItemImage : noImage;
                                                }
                                                else
                                                {
                                                    path = !string.IsNullOrEmpty(featuredProduct.ProductImage) ? ConfigurationManager.AppSettings["ProductImage"] + featuredProduct.ProductImage : noImage;
                                                }
                                                if (featuredProduct.ItemVariationId != null)
                                                {
                                                    <a href="@siteURL/Product/Details/@featuredProduct.ProductId?from=Inventory">
                                                        <img src="@path" alt="">
                                                    </a>
                                                }
                                                else
                                                {
                                                    <a href="@siteURL/Product/Details/@featuredProduct.ProductId?from=Sections">
                                                        <img src="@path" alt="">
                                                    </a>
                                                }
                                                            }
                                                        </div>
                                                        <div class="details fixclear">
                                                            @if (direction == "ltr")
                                                            {
                                                                <h3>@(featuredProduct.ItemVariationId != null ? featuredProduct.ItemNameEn : featuredProduct.ProductNameEn)</h3>
                                                            }
                                                            else
                                                            {
                                                                <h3>@(featuredProduct.ItemVariationId != null ? featuredProduct.ItemNameAr : featuredProduct.ProductNameAr)</h3>
                                                            }
                                                            <p><strong>SKU:</strong> @featuredProduct.SKUCode</p>
                                                            <p class="desc">Quisque sit amet est et sapien ullamcorper pharetra...</p>
                                                            <div class="actions">
                                                                <a class="cursorHand" onclick="addToCart(@featuredProduct.ProductId)">@Product.AddToCart</a>
                                                                @if (featuredProduct.ItemVariationId != null)
                                                                {
                                                                    <a href="@siteURL/Product/Details/@featuredProduct.ProductId?from=Inventory">@Product.More</a>
                                                                }
                                                                else
                                                                {
                                                                    <a href="@siteURL/Product/Details/@featuredProduct.ProductId?from=Sections">@Product.More</a>
                                                                }
                                                            </div>
                                                            <div class="price">
                                                                @if (!string.IsNullOrEmpty(featuredProduct.DiscountedPrice))
                                                                {
                                                                    <span>@featuredProduct.DiscountedPrice</span>
                                                                    <span>SR</span>
                                                                    <small>@featuredProduct.ProductPrice</small>
                                                                }
                                                                else
                                                                {
                                                                    <span>@featuredProduct.ProductPrice</span><span>SR</span>
                                                                }
                                                            </div>
                                                        </div>
                                                    </div><!-- end product-item -->
                                                </li>
                                            }
                                        }
                                    </ul><!-- shop product list -->
                                    <div class="controls">
                                        <a href="#" class="prev"><span class="icon-chevron-left"></span></a>
                                        <a href="#" class="next"><span class="icon-chevron-right"></span></a>
                                    </div>
                                    <div class="clear"></div>
                                </div><!--end shop-latest-carousel -->
                            </div><!-- end tab pane -->

                        </div>
                    </div><!-- /.tabbable -->
                </div><!-- end shop latest -->
            </div>
        </div><!-- end row -->
    </div><!-- end mainbody -->
</section>

@section scripts
{
    <script>
        var siteUrl;
        $(document).ready(function () {
            siteUrl = $("#siteURL").val();
            // latest & bestsellers carousels
            $('.shop-latest-carousel > ul').each(function (index, element) {
                $(this).carouFredSel({
                    responsive: true,
                    scroll: 1,
                    auto: false,
                    height: 406,
                    items: { width: 260, visible: { min: 1, max: 4 } },
                    prev: { button: $(this).parent().find('a.prev'), key: "left" },
                    next: { button: $(this).parent().find('a.next'), key: "right" },
                });
            });
        });
        $(document).on('change', '.filter', function () {
            var sortBy = parseInt($("#SortBy").val());
            if (sortBy == 1 || sortBy == 3 || sortBy == 5) {
                $("#SortDirection").val("asc");
            } else {
                $("#SortDirection").val("desc");
            }
            if (sortBy == 1 || sortBy == 2) {
                $("#sortCol").val("1");
            }
            else if (sortBy == 5 || sortBy == 6) {
                $("#sortCol").val("2");
            }
            else if (sortBy == 3 || sortBy == 4) {
                $("#sortCol").val("3");
            }
            // submit from
            $("#filter-products").submit();
        });
        $(document).on('click', '.page-button', function () {
            $('#pagination a').removeClass("active");
            this.parentElement.classList.add("active");
            var pageNo = parseInt(this.textContent);
            var length = parseInt($('#displayLength').val());
            var displayStart = (pageNo - 1) * length;
            $('#displayStart').val(displayStart);
            // submit from
            $("#filter-products").submit();
        });
        $(document).on('click', '.first-page', function () {
            $('#pagination a').removeClass("active");
            this.parentElement.classList.add("active");
            $('#displayStart').val(0);
            // submit from
            $("#filter-products").submit();
        });
        $(document).on('click', '.last-page', function () {
            $('#pagination a').removeClass("active");
            this.parentElement.classList.add("active");
            var totalCount = parseInt('@Model.SearchRequest.TotalCount');
            var length = parseInt($('#displayLength').val());
            $('#displayStart').val(getLastPage(totalCount, length));
            // submit from
            $("#filter-products").submit();
        });
        function getLastPage(totalCount, length) {
            var totalPages = Math.ceil(totalCount / length);
            return ((totalPages - 1) * length);
        }
    </script>
}