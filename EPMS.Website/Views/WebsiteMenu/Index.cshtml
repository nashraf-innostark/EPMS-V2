@using System.Configuration
@using EPMS.WebModels.Resources.WebsiteClient.Menu
@using EPMS.Website.Resources.Shared
@model EPMS.Models.MenuModels.WebsiteMenuModel
@{
    Layout = null;
    var direction = Common.TextDirection;
    string link = "";
    var siteURL = ConfigurationManager.AppSettings["SiteURL"];
}
<!-- start main_menu -->
<nav id="main_menu">
    <ul class="sf-menu clearfix">
        <li class="active">
            <a href="~/Home/Index">@Menu.Home</a>
        </li>
        <li>
            <a href="javascript:;" class="sf-with-ul">@Menu.AboutUs</a>
            <ul>
                <li>
                    <a href="@siteURL/AboutUs/Detail">@Menu.CompanyProfile</a>
                </li>
            </ul>
        </li>
        <li>
            <a href="javascript:;" class="sf-with-ul">@Menu.OurProducts</a>
            <ul>
                @{
                    //All productSections, who have no parentId
                    var rootProducts = Model.ProductSections.Where(x => x.ParentSectionId == null);
                    foreach (var productSection in rootProducts)
                    {
                        <li>
                            @{
                        //childName variable to just show the name of menu item
                        var childName = "";
                        //put check for culture for eng or arabic field
                        if (direction == "ltr")
                        {
                            childName = string.IsNullOrEmpty(productSection.SectionNameEn) ? productSection.InventoryDepartment.DepartmentNameEn : productSection.SectionNameEn;
                        }
                        else
                        {
                            childName = string.IsNullOrEmpty(productSection.SectionNameAr) ? productSection.InventoryDepartment.DepartmentNameAr : productSection.SectionNameAr;
                        }
                            }
                            @if (productSection.InventoyDepartmentId != null)
                            {
                                link = @siteURL + "/Product/Index/" + productSection.InventoyDepartmentId + "?from=Inventory";
                            }
                            else
                            {
                                link = @siteURL + "/Product/Index/" + productSection.SectionId + "?from=Sections";
                            }
                            <a href="@link">@childName</a>

                            @{
                            //Check if there are departments, then show them all, up to 2nd level
                            if (productSection.InventoryDepartment != null)
                            {
                                <ul>

                                    @foreach (var department in productSection.InventoryDepartment.InventoryDepartments)
                                    {
                                        //first level child from department is here
                                        <li>
                                            @{
                                        //put check for culture for eng or arabic field
                                        childName = direction == "ltr" ? department.DepartmentNameEn : department.DepartmentNameAr;
                                        link = @siteURL + "/Product/Index/" + department.DepartmentId + "?from=Inventory";
                                            }
                                            <a href="@link">@childName</a>

                                            @if (department.InventoryDepartments.Any())
                                            {
                                                //2nd level child from department is here
                                                <ul>
                                                    @foreach (var childDepartment in department.InventoryDepartments)
                                                    {
                                                        <li>
                                                            @{
                                                        //put check for culture for eng or arabic field
                                                        childName = direction == "ltr" ? childDepartment.DepartmentNameEn : childDepartment.DepartmentNameAr;
                                                        link = @siteURL + "/Product/Index/" + childDepartment.DepartmentId + "?from=Inventory";
                                                            }
                                                            <a href="@link">@childName</a>
                                                        </li>
                                                    }
                                                </ul>
                                            }
                                        </li>
                                    }
                                </ul>
                            }
                            else
                            {
                                if (productSection.ProductSections.Any())
                                {
                                    //we are here because we didn't find any department of this roo level productSection, we are going to check if it has child in productSection table
                                    <ul>
                                        @foreach (var product in productSection.ProductSections)
                                        {
                                            //first level child from productSection is here
                                            <li>
                                                @{
                                            //put check for culture for eng or arabic field
                                            if (direction == "ltr")
                                            {
                                                childName = string.IsNullOrEmpty(product.SectionNameEn) ? product.InventoryDepartment.DepartmentNameEn : product.SectionNameEn;
                                            }
                                            else
                                            {
                                                childName = string.IsNullOrEmpty(product.SectionNameAr) ? product.InventoryDepartment.DepartmentNameAr : product.SectionNameAr;
                                            }
                                            link = @siteURL + "/Product/Index/" + product.SectionId + "?from=Sections";
                                                }
                                                <a href="@link">@childName</a>
                                                @if (product.ProductSections.Any())
                                                {
                                                    //2nd level child from productSection is here
                                                    <ul>
                                                        @foreach (var childProduct in product.ProductSections)
                                                        {
                                                            <li>
                                                                @{
                                                            //put check for culture for eng or arabic field
                                                            if (direction == "ltr")
                                                            {
                                                                childName = string.IsNullOrEmpty(childProduct.SectionNameEn) ? childProduct.InventoryDepartment.DepartmentNameEn : childProduct.SectionNameEn;
                                                            }
                                                            else
                                                            {
                                                                childName = string.IsNullOrEmpty(childProduct.SectionNameAr) ? childProduct.InventoryDepartment.DepartmentNameAr : childProduct.SectionNameAr;
                                                            }
                                                            link = @siteURL + "/Product/Index/" + childProduct.SectionId + "?from=Sections";
                                                                }
                                                                <a href="@link">@childName</a>
                                                            </li>
                                                        }
                                                    </ul>
                                                }
                                            </li>
                                        }
                                    </ul>
                                }
                            }

                            }
                        </li>
                    }
                }
            </ul>
        </li>

        <li>
            <a href="javascript:;" class="sf-with-ul">@Menu.OurServices</a>
            <ul>
                @{
                    //All productSections, who have no parentId
                    var rootServices = Model.WebsiteServices.Where(x => x.ParentServiceId == null);
                    foreach (var service in rootServices)
                    {
                        <li>
                            @{
                                var childName = direction == "ltr" ? service.ServiceNameEn : service.ServiceNameAr;
                                link = siteURL + "/Services/Detail/" + service.ServiceId;
                                <a href="@link">@childName</a>
                                if (service.WebsiteServices != null && service.WebsiteServices.Any())
                                {
                                    <ul>
                                        @foreach (var childService in service.WebsiteServices)
                                        {
                                            <li>
                                                @{
                                                    childName = direction == "ltr" ? childService.ServiceNameEn : childService.ServiceNameAr;
                                                    link = siteURL + "/Services/Detail/" + childService.ServiceId;
                                                    <a href="@link">@childName</a>
                                                }
                                            </li>
                                        }
                                    </ul>
                                }
                            }
                        </li>
                    }
                }
                @*@foreach (var service in Model.WebsiteServices)
                {
                    if (direction == "ltr")
                    {
                        <li>
                            <a href="@siteURL/Services/Detail/@service.ServiceId">@service.ServiceNameEn</a>
                        </li>
                    }
                    else
                    {
                        <li>
                            <a href="@siteURL/Services/Detail/@service.ServiceId">@service.ServiceNameAr</a>
                        </li>
                    }
                }*@
            </ul>
        </li>
        <li>
            <a href="javascript:;" class="sf-with-ul">@Menu.NewsArticles</a>
            <ul>
                <li>
                    <a href="@siteURL/NewsAndArticle/Index/0">@Menu.News</a>
                </li>
                <li>
                    <a href="@siteURL/NewsAndArticle/Index/1">@Menu.Articles</a>
                </li>
            </ul>
        </li>
        <li><a href="@siteURL/ContactUs/Detail">@Menu.ContactUs</a></li>
        <li><a href="@ConfigurationManager.AppSettings["Careers"]">@Menu.Careers</a></li>
    </ul>
</nav>
<!-- end main_menu -->